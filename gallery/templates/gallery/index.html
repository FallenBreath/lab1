{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>3D Storage</title>
    <!-- ... –≤–∞—à–∏ —Å—Ç–∞—Ä—ã–µ —Ç–µ–≥–∏ ... -->
    <!-- –í–ê–ñ–ù–û: –≠—Ç–æ –∫–∞—Ä—Ç–∞, —É–∫–∞–∑—ã–≤–∞—é—â–∞—è –±—Ä–∞—É–∑–µ—Ä—É, –≥–¥–µ –±—Ä–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ -->
    <script type="importmap">
    {
        "imports": {
        "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ CSS (–æ—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –±—ã–ª–æ) -->
    {% load static %}
    <link rel="stylesheet" href="{% static 'gallery/style.css' %}">
</head>

<body>
    <header>
        <h1>{{ page_title }}</h1>
        <p>
            <a href="/">–ì–ª–∞–≤–Ω–∞—è</a> | 
            <a href="/about/">–û –ø—Ä–æ–µ–∫—Ç–µ</a> | 
            <a href="/upload/">–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å</a>
        </p>
    </header>

    <main>
        <h2>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∞—Å—Å–µ—Ç—ã:</h2>
       
        <div class="gallery-grid"> 
            {% for asset in assets %}
            <div class="asset-card">
                <!-- –ë–ª–æ–∫ –¥–ª—è –ø—Ä–µ–≤—å—é ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–û! -->
                <div class="card-preview" 
                id="model-container-{{ asset.id }}" 
                data-url="{{ asset.file.url }}">
                 <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –±–ª–æ–∫–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ) -->
                </div>
                
                <div class="card-info">
                    <h3 class="card-title">{{ asset.title }}</h3>
                    
                    <div class="card-meta">
                        <p><strong>–†–∞–∑–º–µ—Ä:</strong> 
                            {% if asset.file %}
                                {{ asset.file.size|filesizeformat }}
                            {% else %}
                                –ù–µ —É–∫–∞–∑–∞–Ω
                            {% endif %}
                        </p>
                        <p><strong>–ó–∞–≥—Ä—É–∂–µ–Ω–æ:</strong> {{ asset.created_at|date:"d.m.Y H:i" }}</p>
                    </div>
                    
                    {% if asset.file %}
                        <a href="{{ asset.file.url }}" class="btn" download>üì• –°–∫–∞—á–∞—Ç—å</a>
                    {% else %}
                        <span style="color: #999;">–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</span>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <p style="grid-column: 1 / -1; text-align: center; padding: 40px;">
                –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç 3D-–º–æ–¥–µ–ª—å!
            </p>
            {% endfor %}
        </div>
    </main>

    <footer>
        <p>&copy; 2024 Web Structures Course</p>
    </footer>
    <!-- index.html (–≤–Ω–∏–∑—É) -->
<!-- type="module" –≤–∫–ª—é—á–∞–µ—Ç —Ä–µ–∂–∏–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ -->
<script type="module">
    // –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é.
    // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –ø—É—Ç—å –∫ JS —á–µ—Ä–µ–∑ static
    import { mountSimpleCube } from "{% static 'gallery/js/viewer.js' %}";
    // –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∫–∞—Ä—Ç–æ—á–µ–∫
    
    const containers = document.querySelectorAll('.card-preview');
    if (containers.length > 0) {
        // –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–∞
        const firstContainer = containers[0];
        // –ü–æ–ª—É—á–∞–µ–º –µ–≥–æ ID (–º—ã –∑–∞–¥–∞–ª–∏ –µ–≥–æ –Ω–∞ –ø—Ä–æ—à–ª–æ–π –Ω–µ–¥–µ–ª–µ: model-container-{{ asset.id }})
        const containerId = firstContainer.id;
        // –ó–∞–ø—É—Å–∫–∞–µ–º –º–∞–≥–∏—é
        mountSimpleCube(containerId);
    }
</script>
</body>
</html>